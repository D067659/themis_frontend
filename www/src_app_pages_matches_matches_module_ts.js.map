{"version":3,"file":"src_app_pages_matches_matches_module_ts.js","mappings":"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","sources":["./src/app/pages/matches/matches-routing.module.ts","./src/app/pages/matches/matches.module.ts","./src/app/pages/matches/matches.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MatchesPage } from './matches.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MatchesPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class MatchesPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MatchesPageRoutingModule } from './matches-routing.module';\n\nimport { MatchesPage } from './matches.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    MatchesPageRoutingModule\n  ],\n  declarations: [MatchesPage]\n})\nexport class MatchesPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { ModalController, ToastController } from '@ionic/angular';\nimport { from } from 'rxjs';\nimport { mergeMap, toArray } from 'rxjs/operators';\nimport { ApiService } from '../../services/api.service';\nimport { NewmatchPage } from '../newmatch/newmatch.page';\nimport { utcToZonedTime } from 'date-fns-tz';\n\n@Component({\n  selector: 'app-matches',\n  templateUrl: './matches.page.html',\n  styleUrls: ['./matches.page.scss'],\n})\nexport class MatchesPage implements OnInit {\n\n  selectedClub = null;\n  clubs = [];\n  matches = [];\n  datepickerinput = null;\n  dataLoaded = false;\n\n  constructor(\n    private apiService: ApiService,\n    private toastController: ToastController,\n    private modalController: ModalController\n  ) { }\n\n  ngOnInit() {\n    this.loadSetup();\n  }\n\n  async loadSetup() {\n    this.selectedClub = this.apiService.currentUser.selectedClub;\n\n    if (!this.selectedClub) {\n      //this.getPossibleClubs()\n      this.getPossibleClubs().subscribe((clubs: any) => {\n        this.clubs = clubs;\n        if (this.clubs.length == 1) { this.setSelectedClub(this.clubs[0]); }\n      });\n    } else {\n      this.getAllMatches();\n    }\n  }\n\n  getAllMatches() {\n    this.apiService.getAllMatches(this.selectedClub._id)\n      .subscribe(matches => {\n        this.matches = matches.filter(match => match.doParticipate !== undefined); // undefined = no participation required, null = no feedback yet\n        this.matches.sort((a, b) => {\n          return new Date(a.startDate).getTime() - new Date(b.startDate).getTime();\n        });\n      })\n  }\n\n  selectParticipation(match) {\n    this.apiService.setParticipationForMatch(match.clubId, match._id, match.doParticipate).subscribe(async (res: any) => {\n      match.isBlocked = true;\n      const answer = res.hasTime ? 'bestÃ¤tigt' : 'abgelehnt';\n      const toast = await this.toastController.create({\n        message: `Teilnahme wurde ${answer}`,\n        duration: 2000,\n        color: res.hasTime ? 'success' : 'warning'\n      });\n      toast.present();\n\n      toast.onDidDismiss().then(() => {\n        match.isBlocked = false;\n      });\n    })\n  }\n\n  getPossibleClubs() {\n    return from(this.apiService.currentUser.clubs).pipe(\n      mergeMap((club: any) => this.apiService.getClubInformation(club.clubId)),\n      toArray()\n    )\n  }\n\n  setSelectedClub(club) {\n    this.selectedClub = club;\n    this.apiService.setSelectedClub(this.selectedClub).then(() => { this.getAllMatches() });\n  }\n\n  resetSelectedClub() {\n    this.selectedClub = null;\n    this.apiService.removeSelectedClub();\n    if (this.clubs.length == 0) {\n      this.getPossibleClubs().subscribe((clubs: any) => { this.clubs = clubs; });\n    }\n  }\n\n  async openNewMatchModal(match?) {\n    const newMatch = await this.modalController.create({\n      component: NewmatchPage,\n      componentProps: {\n        existingMatch: match\n      }\n    });\n\n    newMatch.onDidDismiss()\n      .then((event) => {\n        const refreshPage = event['data'];\n        if (refreshPage) { this.getAllMatches() }\n      });\n    return await newMatch.present();\n  }\n\n  hasAdminRole() {\n    return this.apiService.hasRoleForClub('admin', this.selectedClub._id);\n  }\n\n}\n"],"names":[],"sourceRoot":"webpack:///"}