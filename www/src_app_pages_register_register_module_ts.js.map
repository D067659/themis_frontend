{"version":3,"file":"src_app_pages_register_register_module_ts.js","mappings":"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","sources":["./src/app/pages/register/register-routing.module.ts","./src/app/pages/register/register.module.ts","./src/app/pages/register/register.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { RegisterPage } from './register.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: RegisterPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class RegisterPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { RegisterPageRoutingModule } from './register-routing.module';\n\nimport { RegisterPage } from './register.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    RegisterPageRoutingModule\n  ],\n  declarations: [RegisterPage]\n})\nexport class RegisterPageModule { }\n","import { Component, OnInit } from '@angular/core';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { AlertController, LoadingController, MenuController } from '@ionic/angular';\nimport { ApiService } from 'src/app/services/api.service';\n\n@Component({\n  selector: 'app-register',\n  templateUrl: './register.page.html',\n  styleUrls: ['../login/login.page.scss'],\n})\nexport class RegisterPage implements OnInit {\n\n  credentials: FormGroup;\n  loginUrl = '/home';\n  isExistingUser = true;\n\n  constructor(\n    private fb: FormBuilder,\n    private authService: ApiService,\n    private alertController: AlertController,\n    private router: Router,\n    private activatedRoute: ActivatedRoute,\n    private loadingController: LoadingController,\n    public menu: MenuController\n  ) { }\n\n  ionViewWillEnter() {\n    this.menu.enable(false);\n    this.menu.get().then((menu: HTMLIonMenuElement) => {\n      menu.swipeGesture = false;\n    });\n  }\n\n  async ngOnInit() {\n    this.credentials = this.fb.group({\n      email: [this.activatedRoute.snapshot.queryParamMap.get('email') || '', [Validators.required, Validators.email]],\n      confirmationCode: [this.activatedRoute.snapshot.queryParamMap.get('confirmationCode'), [Validators.required]],\n      clubId: [this.activatedRoute.snapshot.queryParamMap.get('club'), [Validators.required]],\n      password: ['', [Validators.required, Validators.minLength(6)]],\n      name: ['', [Validators.required, Validators.minLength(5)]],\n    });\n\n    if (this.credentials.get('clubId').value || this.credentials.get('confirmationCode').value) {\n      this.checkPlayerData() //this.register()\n    } else {\n      const alert = await this.alertController.create({\n        header: 'Daten fehlen',\n        message: '<center>Um dich einem Verein zuzuordnen, brauchen wir den Registrierungscode. Folge der Bestätigungsmail in deinem E-Mail Postfach um das automatisch zu vervollständigen.</center>',\n        buttons: ['OK'],\n      });\n      await alert.present();\n    }\n  }\n\n  async checkPlayerData() {\n    const loading = await this.loadingController.create();\n    await loading.present();\n    this.authService.checkPlayerData(this.credentials.value).subscribe(\n      async (user: any) => {\n        if (user.email && user.name && user.clubs.length >= 1) {\n          await loading.dismiss();\n          return this.register();\n        } else {\n          await loading.dismiss();\n          this.promtForRegistration();\n        }\n      },\n      async (res) => {\n        await loading.dismiss();\n        const alert = await this.alertController.create({\n          header: 'Registrierung fehlgeschlagen',\n          message: res.error.msg.message,\n          buttons: [{\n            text: 'Zum Login',\n            handler: () => { this.navToLogin() }\n          }],\n        });\n\n        await alert.present();\n      }\n    );\n  }\n\n  async promtForRegistration() {\n    const alert = await this.alertController.create({\n      header: 'Registrierung abschliessen',\n      message: '</center>Fast fertig! Um deinen Benutzeraccount zu vervollständigen brauchen wir noch ein paar Informationen. Bitte fülle diese aus.</center>',\n      buttons: ['OK'],\n    });\n\n    await alert.present();\n  }\n\n  async register() {\n    const loading = await this.loadingController.create();\n    await loading.present();\n    this.authService.register(this.credentials.value).subscribe(\n      async (user: any) => {\n        await loading.dismiss();\n        if (user.email && user.name && user.clubs.length >= 1) {\n          const alert = await this.alertController.create({\n            header: 'Neuer Verein hinzugefügt!',\n            message: 'Du wurdest erfolgreich zu deinem neuen Verein hinzugefügt.',\n            buttons: [{\n              text: 'Zum Login',\n              handler: () => { this.router.navigateByUrl(this.loginUrl, { replaceUrl: true }); }\n            }],\n          });\n          await alert.present();\n        } else {\n          this.isExistingUser = false;\n        }\n      },\n      async (res) => {\n        await loading.dismiss();\n        const alert = await this.alertController.create({\n          header: 'Registrierung fehlgeschlagen',\n          message: res.error.msg.message,\n          buttons: [{\n            text: 'Zum Login',\n            handler: () => { this.navToLogin() }\n          }],\n        });\n\n        await alert.present();\n      }\n    );\n  }\n\n  navToLogin() {\n    this.router.navigateByUrl('/login', { replaceUrl: true });\n  }\n\n  // Easy access for form fields\n  get email() {\n    return this.credentials.get('email');\n  }\n\n  get name() {\n    return this.credentials.get('name');\n  }\n\n  get password() {\n    return this.credentials.get('password');\n  }\n}"],"names":[],"sourceRoot":"webpack:///"}